---
phase: 04-settings-consolidation
plan: 02
type: execute
---

<objective>
Simplify GarminPage to focus on data display only, removing connection/login controls.

Purpose: GarminPage becomes a pure data viewer, all connection management lives in Settings.
Output: Simplified GarminPage that redirects to Settings for connection, shows data when connected.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior work in this phase:**
@.planning/phases/04-settings-consolidation/04-01-SUMMARY.md

**Key source files:**
@src/pages/GarminPage.tsx
@src/features/garmin/components/GarminDataDisplay.tsx
@src/features/garmin/components/DateNavigation.tsx

**Established pattern:**
After 04-01, GarminSettings handles connection. GarminPage should only:
1. Check if connected
2. If not connected: show message + link to Settings
3. If connected: show data display with date navigation
</context>

<tasks>

<task type="auto">
  <name>Task 1: Simplify GarminPage to data viewer only</name>
  <files>src/pages/GarminPage.tsx</files>
  <action>
Refactor GarminPage to remove all connection/login logic:

REMOVE:
- Login state (loginDialogOpen, email, password, isLoggingIn, loginError)
- MFA state (mfaRequired, mfaCode)
- Sync state (isSyncing, syncProgress) - now in GarminSettings
- Login handlers (handleLogin, handleMFA)
- Logout handler (handleLogout) - now in GarminSettings
- Full sync handlers (handleFullSync, handleQuickSync) - now in GarminSettings
- resetLoginForm function
- Demo data handler (handleLoadDemoData) - move to GarminSettings or keep for dev convenience
- Login dialog JSX
- SyncControls component usage
- "Not Connected" card with login button

KEEP:
- Session state check (isLoading, isConnected, profile)
- loadSessionState() for determining connection status
- Date navigation (selectedDate, setSelectedDate, datesWithData)
- handleResync for single-day resync (this is data-focused, not connection-focused)
- GarminDataDisplay component
- DateNavigation component
- Info card at bottom

ADD:
- When not connected AND no demo data: Show card directing user to Settings > Garmin tab
- Link/Button: "Zu den Einstellungen" that navigates to /settings (Garmin tab via URL state or just /settings)

The page should be much simpler:
1. Check isConnected or has demo data
2. If no: show "Go to Settings" prompt
3. If yes: show DateNavigation + GarminDataDisplay + Info card

Keep isResyncing + handleResync for the DateNavigation resync button (single-day refresh is convenient from data view).
  </action>
  <verify>
- Build passes: npm run build
- GarminPage loads without errors
- No login dialog code remains
- When disconnected, shows link to Settings
  </verify>
  <done>
GarminPage is a pure data viewer, directs to Settings for connection management
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Consolidated Settings with GarminSettings tab, simplified GarminPage</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:5173/settings
    3. Click "Garmin" tab
    4. Verify: Login controls appear directly (not a link to another page)
    5. If you have Garmin credentials, test login flow
    6. Visit: http://localhost:5173/garmin
    7. Verify: Page shows "Go to Settings" message when not connected
    8. Verify: Page shows data display when connected/has demo data
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] Settings > Garmin tab has full connection controls
- [ ] GarminPage is simplified to data display only
- [ ] Navigation from GarminPage to Settings works
- [ ] Phase 4 complete
</verification>

<success_criteria>

- All tasks completed
- GarminPage contains no login/sync control code
- User directed to Settings for Garmin connection
- Phase 4: Settings Consolidation complete
</success_criteria>

<output>
After completion, create `.planning/phases/04-settings-consolidation/04-02-SUMMARY.md`:

# Phase 4 Plan 2: GarminPage Simplification Summary

**[One-liner summary]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `src/pages/GarminPage.tsx` - Simplified to data viewer only

## Decisions Made

[Any decisions made]

## Issues Encountered

[Any issues]

## Next Phase Readiness

Phase 4 complete. Ready for Phase 5: UI Mobile Polish.
</output>
